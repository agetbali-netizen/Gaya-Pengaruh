// ... kode HTML dan JavaScript sebelumnya ...

    <script>
        // ... (bagian kode lainnya tetap sama) ...

        function sendResultsToEmail() {
            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            if (!fullName || !email) {
                alert('Nama lengkap dan email diperlukan untuk mengirim hasil.');
                return;
            }
            
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailPattern.test(email)) {
                alert('Format email tidak valid. Silakan periksa kembali.');
                return;
            }
            
            const dominantStyle = Object.keys(answers).reduce((a, b) => answers[a] > answers[b] ? a : b);
            const result = styles[dominantStyle];
            const timestamp = new Date().toLocaleString('id-ID', {
                weekday: 'short', 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            const data = {
                action: 'sendEmailText',
                nama: fullName,
                email: email,
                from: 'agetbali@gmail.com',
                subject: 'Hasil Asesmen Gaya Mempengaruhi - ' + fullName,
                dominantStyle: result.title,
                description: result.description,
                recommendations: result.recommendations.join('\n'),
                scores: JSON.stringify({
                    rationalizing: answers.rationalizing,
                    asserting: answers.asserting,
                    negotiating: answers.negotiating,
                    inspiring: answers.inspiring,
                    bridging: answers.bridging
                }),
                timestamp: timestamp
            };
            
            const button = document.getElementById('email-button');
            const statusElement = document.getElementById('email-status');
            
            button.disabled = true;
            button.innerHTML = '<span class="loading-spinner"></span> Mengirim...';
            statusElement.classList.add('hidden');
            
            // Perbaikan URL Apps Script di sini
            const appsScriptURL = 'https://script.google.com/macros/s/AKfycbxMihbfm34rKxmhDzBXktxgVs5QqtQ7ZcSDtAxlY7zS/exec'; // Ganti /dev menjadi /exec
            
            fetch(appsScriptURL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(result => {
                if (result.error) {
                    throw new Error(result.error);
                }
                
                statusElement.textContent = '✅ Hasil asesmen berhasil dikirim ke email!';
                statusElement.classList.remove('hidden', 'text-red-600');
                statusElement.classList.add('text-green-600');
                
                alert('Hasil asesmen berhasil dikirim ke email!');
            })
            .catch(error => {
                console.error('Error:', error);
                statusElement.textContent = '❌ Gagal mengirim email: ' + error.message;
                statusElement.classList.remove('hidden', 'text-green-600');
                statusElement.classList.add('text-red-600');
                
                alert('Gagal mengirim email: ' + error.message);
            })
            .finally(() => {
                button.disabled = false;
                button.textContent = 'Kirim Hasil ke Email';
            });
        }

        // ... (bagian kode lainnya tetap sama) ...
    </script>
</body>
</html>
