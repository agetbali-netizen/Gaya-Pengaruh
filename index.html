<!DOCTYPE html>
<html lang="id">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Asesmen Gaya Mempengaruhi</title>
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
Â  Â  <style>
Â  Â  Â  Â  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
Â  Â  Â  Â  body { font-family: 'Inter', sans-serif; }
Â  Â  Â  Â  .gradient-bg {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  }
Â  Â  Â  Â  .card-shadow {
Â  Â  Â  Â  Â  Â  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .progress-bar {
Â  Â  Â  Â  Â  Â  transition: width 0.3s ease;
Â  Â  Â  Â  }
Â  Â  Â  Â  @media print {
Â  Â  Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  .no-print {
Â  Â  Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body class="bg-gray-50 min-h-screen">
Â  Â  <div class="gradient-bg text-white py-8 relative no-print">
Â  Â  Â  Â  <div class="container mx-auto px-4">
Â  Â  Â  Â  Â  Â  <div class="absolute top-4 right-4">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="https://agetdevelopment.com/wp-content/uploads/2019/03/AGET-horizontal-logo-2.png" alt="AGET Development Logo" class="h-10">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <h1 class="text-3xl font-bold text-center mb-2">Asesmen Gaya Mempengaruhi</h1>
Â  Â  Â  Â  Â  Â  <p class="text-center text-blue-100">Temukan gaya kepemimpinan dan pengaruh Anda</p>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="bg-white shadow-sm no-print">
Â  Â  Â  Â  <div class="container mx-auto px-4 py-4">
Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-sm font-medium text-gray-600">Progress</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-sm font-medium text-gray-600" id="progress-text">0/20</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="w-full bg-gray-200 rounded-full h-2">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="progress-bar bg-blue-600 h-2 rounded-full" id="progress-bar" style="width: 0%"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="container mx-auto px-4 py-8">
Â  Â  Â  Â  <div class="max-w-4xl mx-auto">
Â  Â  Â  Â  Â  Â  <div class="bg-white rounded-lg card-shadow p-6 mb-8" id="instructions">
Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-xl font-semibold text-gray-800 mb-4">Informasi Peserta</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="fullName" class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="fullName" name="fullName"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  placeholder="Masukkan nama lengkap Anda" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
                <div class="mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="email" id="email" name="email"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  placeholder="Masukkan email Anda" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-semibold text-gray-800 mb-4">Petunjuk Pengisian</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-3 text-gray-600">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>â€¢ Bacalah setiap pernyataan dengan cermat</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>â€¢ Pilih jawaban yang paling menggambarkan diri Anda</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>â€¢ Tidak ada jawaban benar atau salah</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>â€¢ Jawablah dengan jujur sesuai kondisi sebenarnya</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="startAssessment()" class="mt-6 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Mulai Asesmen
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="bg-white rounded-lg card-shadow p-6 hidden" id="assessment">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-sm font-medium text-blue-600" id="question-number">Pertanyaan 1 dari 20</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-semibold text-gray-800 mt-2" id="question-text">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Ketika memimpin tim, saya cenderung...
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-3" id="options-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between mt-8">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="previousQuestion()" id="prev-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-700 px-6 py-2 rounded-lg font-medium transition-colors disabled:opacity-50" disabled>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Sebelumnya
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="nextQuestion()" id="next-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors disabled:opacity-50" disabled>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Selanjutnya
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="bg-white rounded-lg card-shadow p-6 hidden" id="results">
                <p class="text-sm text-center mb-2">Hasil Asesmen untuk: <span id="nama-peserta" class="font-semibold"></span></p>

Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Hasil Asesmen Anda</h2>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid md:grid-cols-2 gap-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-32 h-32 mx-auto mb-4 rounded-full flex items-center justify-center text-4xl" id="result-icon">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ðŸŽ¯
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-xl font-semibold text-gray-800 mb-2" id="result-title">Gaya Direktif</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-600" id="result-description">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Anda memiliki gaya kepemimpinan yang tegas dan berorientasi pada hasil.
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="relative w-80 h-80 mx-auto mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <svg width="320" height="320" viewBox="0 0 320 320" class="mx-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <circle cx="160" cy="160" r="40" fill="none" stroke="#e5e7eb" stroke-width="1"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <circle cx="160" cy="160" r="80" fill="none" stroke="#e5e7eb" stroke-width="1"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <circle cx="160" cy="160" r="120" fill="none" stroke="#e5e7eb" stroke-width="1"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <line x1="160" y1="40" x2="160" y2="280" stroke="#e5e7eb" stroke-width="1"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <line x1="40" y1="160" x2="280" y2="160" stroke="#e5e7eb" stroke-width="1"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <line x1="75" y1="75" x2="245" y2="245" stroke="#e5e7eb" stroke-width="1"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <line x1="245" y1="75" x2="75" y2="245" stroke="#e5e7eb" stroke-width="1"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <text x="160" y="30" text-anchor="middle" class="text-xs font-medium fill-gray-600">Rationalizing</text>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <text x="290" y="165" text-anchor="middle" class="text-xs font-medium fill-gray-600">Asserting</text>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <text x="250" y="290" text-anchor="middle" class="text-xs font-medium fill-gray-600">Negotiating</text>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <text x="70" y="290" text-anchor="middle" class="text-xs font-medium fill-gray-600">Inspiring</text>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <text x="30" y="165" text-anchor="middle" class="text-xs font-medium fill-gray-600">Bridging</text>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <polygon id="result-polygon" points="160,160 160,160 160,160 160,160 160,160"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fill="rgba(59, 130, 246, 0.3)" stroke="#3b82f6" stroke-width="2"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <circle id="point-rationalizing" cx="160" cy="160" r="4" fill="#3b82f6"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <circle id="point-asserting" cx="160" cy="160" r="4" fill="#ef4444"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <circle id="point-negotiating" cx="160" cy="160" r="4" fill="#10b981"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <circle id="point-inspiring" cx="160" cy="160" r="4" fill="#8b5cf6"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <circle id="point-bridging" cx="160" cy="160" r="4" fill="#f59e0b"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-4 text-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>Rationalizing</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="rationalizing-score" class="font-medium">0</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>Asserting</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="asserting-score" class="font-medium">0</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>Negotiating</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="negotiating-score" class="font-medium">0</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>Inspiring</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="inspiring-score" class="font-medium">0</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>Bridging</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="bridging-score" class="font-medium">0</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="mt-8 p-4 bg-blue-50 rounded-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 class="font-semibold text-gray-800 mb-2">Rekomendasi Pengembangan:</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <ul class="text-gray-600 space-y-1" id="recommendations">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>â€¢ Kembangkan kemampuan mendengarkan aktif</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>â€¢ Berikan lebih banyak ruang untuk partisipasi tim</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>â€¢ Latih kemampuan delegasi yang efektif</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center mt-6 no-print">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="sendResultsByEmail()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors mr-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Kirim Hasil ke Email
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="restartAssessment()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Ulangi Asesmen
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  const questions = [
Â  Â  Â  Â  Â  Â  { text: "Saya selalu menyiapkan data dan fakta sebelum meyakinkan orang lain", type: "rationalizing" },
Â  Â  Â  Â  Â  Â  { text: "Saya percaya diri dalam menyampaikan pendapat saya", type: "asserting" },
Â  Â  Â  Â  Â  Â  { text: "Saya suka mencari solusi yang menguntungkan semua pihak", type: "negotiating" },
Â  Â  Â  Â  Â  Â  { text: "Saya sering menginspirasi orang dengan visi masa depan", type: "inspiring" },
Â  Â  Â  Â  Â  Â  { text: "Saya membangun hubungan personal sebelum mempengaruhi", type: "bridging" },
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  { text: "Saya menggunakan grafik dan statistik dalam presentasi", type: "rationalizing" },
Â  Â  Â  Â  Â  Â  { text: "Saya tidak ragu mengambil keputusan sulit", type: "asserting" },
Â  Â  Â  Â  Â  Â  { text: "Saya mempertimbangkan kepentingan berbagai pihak", type: "negotiating" },
Â  Â  Â  Â  Â  Â  { text: "Saya suka berbagi cerita yang memotivasi", type: "inspiring" },
Â  Â  Â  Â  Â  Â  { text: "Saya mencari kesamaan dengan lawan bicara", type: "bridging" },
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  { text: "Saya menyajikan analisis mendalam untuk mendukung argumen", type: "rationalizing" },
Â  Â  Â  Â  Â  Â  { text: "Saya tegas dalam menyampaikan ekspektasi", type: "asserting" },
Â  Â  Â  Â  Â  Â  { text: "Saya terbuka untuk berkompromi demi kesepakatan", type: "negotiating" },
Â  Â  Â  Â  Â  Â  { text: "Saya menghubungkan tugas dengan tujuan yang lebih besar", type: "inspiring" },
Â  Â  Â  Â  Â  Â  { text: "Saya membangun trust sebelum meminta sesuatu", type: "bridging" },
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  { text: "Saya menggunakan riset dan benchmark dalam proposal", type: "rationalizing" },
Â  Â  Â  Â  Â  Â  { text: "Saya menekankan urgensi untuk mendorong tindakan", type: "asserting" },
Â  Â  Â  Â  Â  Â  { text: "Saya mencari win-win solution dalam negosiasi", type: "negotiating" },
Â  Â  Â  Â  Â  Â  { text: "Saya menggambarkan visi yang menginspirasi perubahan", type: "inspiring" },
Â  Â  Â  Â  Â  Â  { text: "Saya melibatkan orang lain dalam proses pengambilan keputusan", type: "bridging" }
Â  Â  Â  Â  ];

Â  Â  Â  Â  let currentQuestion = 0;
Â  Â  Â  Â  let answers = { rationalizing: 0, asserting: 0, negotiating: 0, inspiring: 0, bridging: 0 };
Â  Â  Â  Â  let selectedAnswer = null;

Â  Â  Â  Â  function startAssessment() {
Â  Â  Â  Â  Â  Â  const fullName = document.getElementById('fullName').value.trim();
Â  Â  Â  Â  Â  Â  const email = document.getElementById('email').value.trim();
Â  Â  Â  Â  Â  Â  if (!fullName || !email) {
Â  Â  Â  Â  Â  Â  Â  Â  alert('Silakan masukkan nama lengkap dan email Anda terlebih dahulu.');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('instructions').classList.add('hidden');
Â  Â  Â  Â  Â  Â  document.getElementById('assessment').classList.remove('hidden');
Â  Â  Â  Â  Â  Â  showQuestion();
Â  Â  Â  Â  }

Â  Â  Â  Â  function showQuestion() {
Â  Â  Â  Â  Â  Â  const question = questions[currentQuestion];
Â  Â  Â  Â  Â  Â  document.getElementById('question-number').textContent = `Pertanyaan ${currentQuestion + 1} dari ${questions.length}`;
Â  Â  Â  Â  Â  Â  document.getElementById('question-text').textContent = question.text;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const container = document.getElementById('options-container');
Â  Â  Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const yesOption = document.createElement('div');
Â  Â  Â  Â  Â  Â  yesOption.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-green-50 transition-colors">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="radio" name="answer" value="yes" class="mr-3 text-green-600">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-700 font-medium">Ya</span>
Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  container.appendChild(yesOption);

Â  Â  Â  Â  Â  Â  const noOption = document.createElement('div');
Â  Â  Â  Â  Â  Â  noOption.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-red-50 transition-colors">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="radio" name="answer" value="no" class="mr-3 text-red-600">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-700 font-medium">Tidak</span>
Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  container.appendChild(noOption);

Â  Â  Â  Â  Â  Â  // Add event listeners
Â  Â  Â  Â  Â  Â  const radios = container.querySelectorAll('input[type="radio"]');
Â  Â  Â  Â  Â  Â  radios.forEach(radio => {
Â  Â  Â  Â  Â  Â  Â  Â  radio.addEventListener('change', function() {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  selectedAnswer = this.value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('next-btn').disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  updateProgress();
Â  Â  Â  Â  Â  Â  updateButtons();
Â  Â  Â  Â  }

Â  Â  Â  Â  function nextQuestion() {
Â  Â  Â  Â  Â  Â  if (selectedAnswer) {
Â  Â  Â  Â  Â  Â  Â  Â  if (selectedAnswer === 'yes') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  answers[questions[currentQuestion].type]++;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  selectedAnswer = null;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (currentQuestion < questions.length - 1) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentQuestion++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showQuestion();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showResults();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function previousQuestion() {
Â  Â  Â  Â  Â  Â  if (currentQuestion > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  currentQuestion--;
Â  Â  Â  Â  Â  Â  Â  Â  showQuestion();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateProgress() {
Â  Â  Â  Â  Â  Â  const progress = ((currentQuestion + 1) / questions.length) * 100;
Â  Â  Â  Â  Â  Â  document.getElementById('progress-bar').style.width = progress + '%';
Â  Â  Â  Â  Â  Â  document.getElementById('progress-text').textContent = `${currentQuestion + 1}/${questions.length}`;
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateButtons() {
Â  Â  Â  Â  Â  Â  document.getElementById('prev-btn').disabled = currentQuestion === 0;
Â  Â  Â  Â  Â  Â  document.getElementById('next-btn').disabled = !selectedAnswer;
Â  Â  Â  Â  }

Â  Â  Â  Â  function showResults() {
Â  Â  Â  Â  Â  Â  document.getElementById('assessment').classList.add('hidden');
Â  Â  Â  Â  Â  Â  document.getElementById('results').classList.remove('hidden');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Tampilkan nama peserta di hasil
Â  Â  Â  Â  Â  Â  document.getElementById('nama-peserta').textContent = document.getElementById('fullName').value.trim();

Â  Â  Â  Â  Â  Â  // Calculate scores (out of 4 questions each)
Â  Â  Â  Â  Â  Â  const maxScore = 4;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Find dominant style
Â  Â  Â  Â  Â  Â  const dominantStyle = Object.keys(answers).reduce((a, b) =>Â 
Â  Â  Â  Â  Â  Â  Â  Â  answers[a] > answers[b] ? a : b
Â  Â  Â  Â  Â  Â  );

Â  Â  Â  Â  Â  Â  const styles = {
Â  Â  Â  Â  Â  Â  Â  Â  rationalizing: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: "Rationalizing (Rasionalisasi)",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon: "ðŸ“Š",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  description: "Anda cenderung mempengaruhi orang lain dengan menggunakan data, fakta, dan argumen logis. Anda percaya pada kekuatan analisis dan bukti empiris untuk meyakinkan orang lain.",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  recommendations: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Kembangkan kemampuan storytelling untuk melengkapi data",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Latih empati untuk memahami perspektif emosional",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Pelajari cara menyederhanakan informasi kompleks"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  asserting: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: "Asserting (Asertif)",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon: "ðŸ’ª",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  description: "Anda mempengaruhi dengan menunjukkan kepercayaan diri dan ketegasan. Anda tidak ragu menyatakan posisi dan menggunakan otoritas untuk mencapai tujuan.",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  recommendations: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Kembangkan kemampuan mendengarkan aktif",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Latih fleksibilitas dalam pendekatan",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Pelajari cara membangun konsensus, bukan hanya compliance"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  negotiating: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: "Negotiating (Negosiasi)",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon: "ðŸ¤",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  description: "Anda mahir dalam mencari win-win solution dan membangun kesepakatan yang menguntungkan semua pihak. Anda fokus pada pertukaran nilai dan kompromi yang adil.",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  recommendations: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Kembangkan kemampuan inspirasi untuk visi jangka panjang",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Latih ketegasan saat diperlukan keputusan cepat",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Pelajari cara membangun trust yang lebih mendalam"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  inspiring: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: "Inspiring (Inspirasi)",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon: "âœ¨",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  description: "Anda mempengaruhi dengan menciptakan visi yang menarik dan menghubungkan tujuan dengan nilai-nilai yang lebih besar. Anda mampu memotivasi melalui purpose dan meaning.",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  recommendations: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Kembangkan kemampuan analisis untuk mendukung visi",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Latih keterampilan eksekusi yang praktis",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Pelajari cara mengukur dan melacak progress inspirasi"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  bridging: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: "Bridging (Membangun Jembatan)",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon: "ðŸŒ‰",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  description: "Anda mempengaruhi dengan membangun hubungan personal yang kuat dan mencari kesamaan. Anda fokus pada koneksi emosional dan trust sebagai fondasi pengaruh.",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  recommendations: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Kembangkan kemampuan mengambil keputusan sulit",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Latih keterampilan presentasi yang lebih impactful",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "â€¢ Pelajari cara menggunakan data untuk memperkuat hubungan"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const result = styles[dominantStyle];
Â  Â  Â  Â  Â  Â  document.getElementById('result-icon').textContent = result.icon;
Â  Â  Â  Â  Â  Â  document.getElementById('result-title').textContent = result.title;
Â  Â  Â  Â  Â  Â  document.getElementById('result-description').textContent = result.description;

Â  Â  Â  Â  Â  Â  // Update scores
Â  Â  Â  Â  Â  Â  document.getElementById('rationalizing-score').textContent = answers.rationalizing;
Â  Â  Â  Â  Â  Â  document.getElementById('asserting-score').textContent = answers.asserting;
Â  Â  Â  Â  Â  Â  document.getElementById('negotiating-score').textContent = answers.negotiating;
Â  Â  Â  Â  Â  Â  document.getElementById('inspiring-score').textContent = answers.inspiring;
Â  Â  Â  Â  Â  Â  document.getElementById('bridging-score').textContent = answers.bridging;

Â  Â  Â  Â  Â  Â  // Calculate polygon points (center at 160,160, max radius 120)
Â  Â  Â  Â  Â  Â  const center = 160;
Â  Â  Â  Â  Â  Â  const maxRadius = 120;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Pentagon coordinates
Â  Â  Â  Â  Â  Â  const points = [
Â  Â  Â  Â  Â  Â  Â  Â  [center, center - (answers.rationalizing / maxScore) * maxRadius], // Rationalizing (top)
Â  Â  Â  Â  Â  Â  Â  Â  [center + (answers.asserting / maxScore) * maxRadius * 0.95, center - (answers.asserting / maxScore) * maxRadius * 0.31], // Asserting (top right)
Â  Â  Â  Â  Â  Â  Â  Â  [center + (answers.negotiating / maxScore) * maxRadius * 0.59, center + (answers.negotiating / maxScore) * maxRadius * 0.81], // Negotiating (bottom right)
Â  Â  Â  Â  Â  Â  Â  Â  [center - (answers.inspiring / maxScore) * maxRadius * 0.59, center + (answers.inspiring / maxScore) * maxRadius * 0.81], // Inspiring (bottom left)
Â  Â  Â  Â  Â  Â  Â  Â  [center - (answers.bridging / maxScore) * maxRadius, center] // Bridging (left)
Â  Â  Â  Â  Â  Â  ];
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Update polygon
Â  Â  Â  Â  Â  Â  const polygonPoints = points.map(p => `${p[0]},${p[1]}`).join(' ');
Â  Â  Â  Â  Â  Â  document.getElementById('result-polygon').setAttribute('points', polygonPoints);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Update individual points
Â  Â  Â  Â  Â  Â  document.getElementById('point-rationalizing').setAttribute('cx', points[0][0]);
Â  Â  Â  Â  Â  Â  document.getElementById('point-rationalizing').setAttribute('cy', points[0][1]);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('point-asserting').setAttribute('cx', points[1][0]);
Â  Â  Â  Â  Â  Â  document.getElementById('point-asserting').setAttribute('cy', points[1][1]);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('point-negotiating').setAttribute('cx', points[2][0]);
Â  Â  Â  Â  Â  Â  document.getElementById('point-negotiating').setAttribute('cy', points[2][1]);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('point-inspiring').setAttribute('cx', points[3][0]);
Â  Â  Â  Â  Â  Â  document.getElementById('point-inspiring').setAttribute('cy', points[3][1]);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('point-bridging').setAttribute('cx', points[4][0]);
Â  Â  Â  Â  Â  Â  document.getElementById('point-bridging').setAttribute('cy', points[4][1]);

Â  Â  Â  Â  Â  Â  // Update recommendations
Â  Â  Â  Â  Â  Â  const recList = document.getElementById('recommendations');
Â  Â  Â  Â  Â  Â  recList.innerHTML = result.recommendations.map(rec => `<li>${rec}</li>`).join('');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Submit data to Google Sheets
Â  Â  Â  Â  Â  Â  submitToSpreadsheet(dominantStyle, answers);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  function submitToSpreadsheet(dominantStyle, scores) {
Â  Â  Â  Â  Â  Â  const fullName = document.getElementById('fullName').value.trim();
Â  Â  Â  Â  Â  Â  const email = document.getElementById('email').value.trim();
Â  Â  Â  Â  Â  Â  const timestamp = new Date().toLocaleString('id-ID');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const data = {
Â  Â  Â  Â  Â  Â  Â  Â  timestamp: timestamp,
Â  Â  Â  Â  Â  Â  Â  Â  nama: fullName,
Â  Â  Â  Â  Â  Â  Â  Â  email: email,
Â  Â  Â  Â  Â  Â  Â  Â  dominantStyle: dominantStyle,
Â  Â  Â  Â  Â  Â  Â  Â  rationalizing: scores.rationalizing,
Â  Â  Â  Â  Â  Â  Â  Â  asserting: scores.asserting,
Â  Â  Â  Â  Â  Â  Â  Â  negotiating: scores.negotiating,
Â  Â  Â  Â  Â  Â  Â  Â  inspiring: scores.inspiring,
Â  Â  Â  Â  Â  Â  Â  Â  bridging: scores.bridging
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  fetch('https://script.google.com/macros/s/AKfycbxw06ITHAYWQo20w0YFSEnGxWZi1IHiiQ1Gp8vgPiYsJ8e5XleX-4JPj0ZAJQEC19cqwg/exec', {
Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  mode: 'no-cors',
Â  Â  Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'Content-Type': 'application/json',
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(data)
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  console.log('Data berhasil dikirim ke spreadsheet');
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch((error) => {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Error mengirim data ke spreadsheet:', error);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  // Fungsi untuk mengirim PDF ke email melalui Google Apps Script
Â  Â  Â  Â  async function sendResultsByEmail() {
Â  Â  Â  Â  Â  Â  const email = document.getElementById('email').value.trim();
Â  Â  Â  Â  Â  Â  const fullName = document.getElementById('fullName').value.trim();
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (!email) {
Â  Â  Â  Â  Â  Â  Â  Â  alert('Silakan masukkan email Anda terlebih dahulu.');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const buttonEmail = document.querySelector('.no-print button');
Â  Â  Â  Â  Â  Â  buttonEmail.textContent = 'Membuat PDF & Mengirim...';
Â  Â  Â  Â  Â  Â  buttonEmail.disabled = true;

Â  Â  Â  Â  Â  Â  const resultsElement = document.getElementById('results');
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  // Sembunyikan tombol sebelum membuat PDF
Â  Â  Â  Â  Â  Â  const buttonsToHide = document.querySelectorAll('#results .no-print');
Â  Â  Â  Â  Â  Â  buttonsToHide.forEach(btn => btn.style.display = 'none');

Â  Â  Â  Â  Â  Â  // Opsi untuk html2pdf.js
Â  Â  Â  Â  Â  Â  const options = {
Â  Â  Â  Â  Â  Â  Â  Â  margin: 10,
Â  Â  Â  Â  Â  Â  Â  Â  filename: 'Hasil_Asesmen_Gaya_Mempengaruhi.pdf',
Â  Â  Â  Â  Â  Â  Â  Â  image: { type: 'jpeg', quality: 0.98 },
Â  Â  Â  Â  Â  Â  Â  Â  html2canvas: { scale: 2 },
Â  Â  Â  Â  Â  Â  Â  Â  jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const pdfBlob = await html2pdf().from(resultsElement).output('blob');
Â  Â  Â  Â  Â  Â  Â  Â  const pdfBase64 = await new Promise(resolve => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  reader.onloadend = () => resolve(reader.result.split(',')[1]);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  reader.readAsDataURL(pdfBlob);
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  const dataToSend = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  action: 'sendEmail',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  recipientEmail: email,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pdfData: pdfBase64,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subject: `Hasil Asesmen Gaya Mempengaruhi - ${fullName}`,
Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch('https://script.google.com/macros/s/AKfycbzgWQW3eLghUWfLcxdaSB20yNXWbtcU8a-uAtGwE7-wP230lvLqW_pTvNDgMcIma2eL1w/exec', {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'Content-Type': 'application/json',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(dataToSend),
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert('Hasil asesmen berhasil dikirim ke email Anda!');
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert('Gagal mengirim email. Silakan coba lagi. Status: ' + response.status);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Error saat membuat PDF atau mengirim email:', error);
Â  Â  Â  Â  Â  Â  Â  Â  alert('Terjadi kesalahan. Mohon coba lagi nanti.');
Â  Â  Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  Â  Â  Â  buttonEmail.textContent = 'Kirim Hasil ke Email';
Â  Â  Â  Â  Â  Â  Â  Â  buttonEmail.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  // Tampilkan kembali tombol
Â  Â  Â  Â  Â  Â  Â  Â  buttonsToHide.forEach(btn => btn.style.display = '');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function restartAssessment() {
Â  Â  Â  Â  Â  Â  currentQuestion = 0;
Â  Â  Â  Â  Â  Â  answers = { rationalizing: 0, asserting: 0, negotiating: 0, inspiring: 0, bridging: 0 };
Â  Â  Â  Â  Â  Â  selectedAnswer = null;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('results').classList.add('hidden');
Â  Â  Â  Â  Â  Â  document.getElementById('instructions').classList.remove('hidden');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('progress-bar').style.width = '0%';
Â  Â  Â  Â  Â  Â  document.getElementById('progress-text').textContent = '0/20';
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>
